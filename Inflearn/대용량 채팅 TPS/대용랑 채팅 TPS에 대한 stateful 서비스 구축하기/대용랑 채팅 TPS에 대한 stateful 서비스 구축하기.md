# 1. 2탄으로 찾아뵙게 되어서 반갑습니다.
## 어떤 강의를 준비하였는지 알려드리겠습니다.
==1편처럼 쓸개간 다 뺀 강의가 아니라 실무에서 실제로 사용하는 방향으로 강의가 준비되었다==
## 여러분들은 이런 채팅방 관리하는 서버를 만들거에요.
==기존 1편과 다르게 DB, 방생성, 채팅 유지등이 추가되었다.==
## 여러분들은 이런 시스템을 구축 할 예정이에요.
==주키퍼, 카프카, 서버 사용에 시연영상==
****
# 2. 3 Tier Architecture를 구성하면서 시작해봅시다.
## 처음 뵙는분들! 이전 강의에 대한 소스코드를 간단하게 알려드릴게요
==1편의 코드를 리뷰하는데 왜 1편에 없던 기능들이 어디서 추가됫는지 곤란하지만 천천히 따라갈것..==
## 여러개의 서버를 띄우는 강의기 떄문에, 편리성을 위해 Flag를 셋팅할게요.
==Flag command에서 전달할 수 있는 값을 추가==
## 환경변수 매우 중요하죠! 환경변수를 통해서 서버를 실행해볼게요.
## 이러면 Skelton 서버가 구축이 됩니다.
[[Skelton?]]
==최대한 기존 코드를 건드리지 않으면서 network 모듈 리팩토링==
## MySQL에 쿼리를 작성할껀데, ORM은 사용해야할까요?
==ORM을 사용하면 쿼리 추적, 튜닝이 어렵다. DB의 능력이 오르는 느낌보다는 ORM의 기술이 오르는 느낌일꺼라 잘 판단해서 사용하는게 좋다.==
## Paging, Sort 쿼리도 한번 맛을 보면서 알아봐요.
==List형태로 리턴하는 Query작성==
## 실무에서는 이런 구조로 서버가 구성이 되고있어요.
==기본적인 Repository => Service => Controller 같은 구조로 작성 하지만 go style==
## API가 모두 작성이 되었으니, Request에 대한 검증을 진행할게요.
==API 작성==
****
# 3. MySQL을 통해서 Schema를 설계하며, 꿀팁을 배워가세요.
## MySQL에서 테이블 생성은 어떻게하고, 시간에 대한 타입은 뭐가 다를까요?
### ERD 다이어그램
- 실무에서는 [ERD클라우드](https://www.erdcloud.com/) 사이드 프로젝트는 [Draw.io](https://app.diagrams.net/) 추천
### MySQL 시간 타입
- BIGINT -> unix
	- default 불가능
- dateTime -> timezone
	- 실무에서는 dateTime을 쓸것
- timestamp ->
	- 2040년 특정 시간이후 오버플로우 발생 가능
## 강의에서 사용하는 나머지 테이블을 생성해보고, Bool 타입과 TinyInt 타입은 동일할까요?
### bool Type?
- 생성은 bool type `describe table`를 하면 tinyint로 저장되어 있음.
****
# 4. wss, HTTP 프로토콜을 활용하여 서버와 통신하고, DB에 접근해봐요.
## HTTP Protocol을 활용해여 서버에 접근해봐요.
==서버 구동후에 API 테스트를 통해 정상 동작 여부를 확인하고, 발생한 오류에 대해 디버깅을 수행했다.==
## wss Protocol을 활용해서 서버에 접근해봐요.
==chat table insert 작성 및 리팩토링==
## 이제 테스트를 해볼게요. FE 연동을 통해 서버의 디버깅을 진행해봐요.
==프런트 실행후 채팅방, 채팅 기록 확인==
****
# 5. 이제 Kafka를 내 컴퓨터에 한번 설정하고 구동해볼게요.
## 이 강의에서 다룰 zero-downtime-deploy를 위한 아키텍처 구조도를 알려드릴게요
==stateless server일 경우에는 여러개의 server중 하나가 죽었어도 `Controller Server`같은 곳에서 로드밸런싱으로 다른 서버에 보내면 되는건데 stateful server의 경우에는 해당 커넥션이 연결되어 있는 서버가 죽어버리면 이 커넥션을 유지하기 위해 다른 서버에 커넥션을 죽은 서버의 커넥션은 나눠가져야함. 그러다가 또 죽은 서버를 살렸을 경우에도 커넥션을 나눠야하는 일이 발생 그래서 강사는 서버가 죽었어도 바로 커넥션을 나누지 않고 retry를 하는 방식을 추천==
## kafka를 구동하기 전에, 우선 zookeeper를 구동하고 설정해볼게요.
### Zookeeper와 kafka
- kafka는 zookeeper가 존재해야만 kafka가 구동이 될 수 있다.(현재는 미래에는 아님!)
- zookeeper는 카프카에서 발생하는 브로커나 메타데이터를 기본적으로 관리하는 컨트롤 서버 같은 느낌
[Docker Compose zookeeper 참고 블로그](https://devocean.sk.com/blog/techBoardDetail.do?ID=164016)

****
# 6. Kafka도 구동시켰으니, 서버에서 Kafka를 한번 활용해볼게요.

****
# 7. 서버의 상태 관리를 위한 Controller Tower 서버를 추가로 만들어볼게요.

****
# 8. Go너무 어려운데... Node.Js는 없나요??

****
# 9. 강의에 대한 전반적인 소스코드 제공해 드릴게요.

****