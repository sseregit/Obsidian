[면접관이 물었다. 만일 스택이 매우 커질 수 있다면 힙은 불필요할까?](https://www.youtube.com/watch?v=9TSojdIr8Q0)

**스택(Stack)과 힙(Heap)은 메모리를 사용하는 목적과 특성이 다르다!**
## Stack 메모리 관련 필수 답변
- 함수의 지역변수(자동변수), 매개변수, 반환주소 등이 사용하는 선형 메모리 공간
- 컴파일 타임에 필요한 메모리 공간의 크기가 확인될 수 있으며 이는 전적으로 **지역변수의 수명을 추적**할 수 있기 때문에 가능
- 호출 스택이 무한정 늘어나는 것은 논리적으로 비효율적인 코드일 수 있음
- 동적 배열 등을 활용하는 경우 혹은 그와 유사한 경우에 힙의 역할을 일부 대체할 수 있다.
## 스택과 멀티스레딩 이슈
- 스택에 특정 함수 범위를 넘어서도 존재해야 하는 변수(혹은 인스턴스)를 관리하기 어려움
- 특히 멀티스레딩 환경에서 여러 스레드가 동시에 접근해야할 필요성이 있는 대상 메모리가 필요할 경우 구현이 어렵거나 구조적으로 불가능
## 힙 메모리 파편화(Fragmentation)
- H/W, OS 수준에서 메모리는 일정 블록(Allocation, Page)단위로 관리
	- 응용 프로그램 수준에서 모든 메모리는 가상 메모리 환경이며 이는 1차원적 선형 구조
	- 내부 파편화 발생
- 내부, 외부 파편화로 나뉨
	- 메모리가 여러 작은 조각으로 나뉜 탓에 큰 덩어리를 할당하지 못하는 문제
### 힙 메모리 파편화 해결 방법 
#### #1 메모리 풀 사용
- 마치 배열처럼 미리 할당해두고 재사용하는 방식
- 네트워크 패킷처럼 최대 크기가 이미 정해진 환경에서 매우 유리
	- 게임 서버가 접속 사용자 단위로 할당할 메모리 크기 응용
#### #2 GC 직접 구현
- JVM 메모리 구조를 적용해 메모리 재정렬
- Mark & Compact
#### #3 Best fit, Worst fit 전략
- 가장 적절한 빈 공간을 찾아 할당
	- 파편화를 줄일 수 있으나 메모리 할당 시간이 크게 증가
- 가장 큰 빈 공간을 찾아 할당
	- 가장 큰 빈 공간을 사용함으로써 더 작은 메모리 공간이 사용될 경우에 미리 대비